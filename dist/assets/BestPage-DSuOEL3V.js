import{U as f,b as _,a as v,L as F}from"./UiPagination-DXASbgQk.js";import{_ as y,c as l,a as o,b as g,d as b,e as h,n as P,F as D,r as a,o as n}from"./index-oHZwTHRo.js";import"./UiButton-CoeeNHVy.js";const k={components:{ListMovies:F,UiSorting:v,UiFilter:_,UiPagination:f},data(){return{urlBase:"https://api.themoviedb.org/3",bestMovies:[],genres:[],loaded:!1,domenFilter:"",genresFilter:"",ratingFilter:[],fromDateFilter:"",toDateFilter:"",typeSort:"vote_average.desc",countPages:1,totalPages:null}},methods:{async getBestMovies(){this.loaded=!1;const e=await fetch(`${this.urlBase}/movie/top_rated?api_key=899ff14e8c54a1207e2a3795988ebb78&language=ru-RU&page=${this.countPages}`);if(e.ok){const t=await e.json();this.totalPages=Number(t.total_pages),this.bestMovies=t.results}else console.log("kdjfghd");this.genres.length>0&&(this.loaded=!0)},async getDataGenres(){const e=await fetch(`${this.urlBase}/genre/movie/list?api_key=899ff14e8c54a1207e2a3795988ebb78&vote_count.gte=1000&language=ru-RU`);if(e.ok){const t=await e.json();this.genres=t.genres}else console.log("kdjfghd");this.bestMovies.length>0&&(this.loaded=!0)},async getFilterMovies(){this.loaded=!1,this.domenFilter="",this.genresFilter.length>0&&(this.domenFilter+=`&with_genres=${this.genresFilter}`),this.ratingFilter.length>0&&(this.domenFilter+=`&vote_average.gte=${this.ratingFilter[0]}&vote_average.lte=${this.ratingFilter[1]}`),this.fromDateFilter.length>0&&(this.domenFilter+=`&primary_release_date.gte=${this.fromDateFilter}`),this.toDateFilter.length>0&&(this.domenFilter+=`&primary_release_date.lte=${this.toDateFilter}`),this.typeSort.length>0&&(this.domenFilter+=`&sort_by=${this.typeSort}`);const e=await fetch(`${this.urlBase}/discover/movie?api_key=899ff14e8c54a1207e2a3795988ebb78&with_genres=${this.domenFilter}&vote_count.gte=1000&language=ru-RU&page=${this.countPages}`);if(e.ok){const t=await e.json();this.totalPages=Number(t.total_pages),this.bestMovies=t.results}else console.log("kdjfghd");this.loaded=!0},getDataFilter(s,e,t,c){this.genresFilter=s.join(","),this.ratingFilter=e,this.fromDateFilter=t,this.toDateFilter=c,this.countPages=1,this.getFilterMovies()},getDataSort(s){this.countPages=1,this.typeSort=s,this.getFilterMovies()},openNewPage(s){this.countPages=s,this.domenFilter.length>0?this.getFilterMovies():this.getBestMovies()}},mounted(){this.getBestMovies(),this.getDataGenres()}},M={class:"filters-container"},B={key:1,class:"not-found-block"},w={key:2,class:"load-animation-container"};function S(s,e,t,c,i,r){const d=a("ui-filter"),u=a("ui-sorting"),p=a("list-movies"),m=a("ui-pagination");return n(),l(D,null,[o("div",M,[g(d,{genres:i.genres,onFilterData:r.getDataFilter},null,8,["genres","onFilterData"]),g(u,{onSortData:r.getDataSort},null,8,["onSortData"])]),i.loaded&&this.bestMovies.length>0?(n(),b(p,{key:0,movies:i.bestMovies,genres:i.genres},null,8,["movies","genres"])):h("",!0),i.loaded&&this.bestMovies.length===0?(n(),l("div",B,[...e[0]||(e[0]=[o("p",null,"По вашему запросу ничего не найдено",-1)])])):h("",!0),i.loaded?h("",!0):(n(),l("div",w,[...e[1]||(e[1]=[o("i",{class:"fa-solid fa-circle-notch fa-spin"},null,-1)])])),o("div",{class:P(["pagination-hidden-container",this.loaded?"":"hidden-block"])},[g(m,{countPages:i.countPages,onUpdateCountPage:r.openNewPage,totalPages:i.totalPages},null,8,["countPages","onUpdateCountPage","totalPages"])],2)],64)}const N=y(k,[["render",S],["__scopeId","data-v-d4e4d678"]]);export{N as default};
