import{U as m,b as _,a as F,L as v}from"./UiPagination-Bw0lHdnJ.js";import{_ as y,c as h,a as n,b as r,e as c,d as D,n as b,F as k,r as o,o as l}from"./index-D2VDRkuz.js";import"./UiButton-DPe_yz0q.js";const P={components:{ListMovies:v,UiSorting:F,UiFilter:_,UiPagination:m},data(){return{urlBase:"https://api.themoviedb.org/3",bestMovies:[],genres:[],loaded:!1,domenFilter:"",genresFilter:"",ratingFilter:[],fromDateFilter:"",toDateFilter:"",typeSort:"vote_average.desc",countPages:1}},methods:{async getBestMovies(){this.loaded=!1;const e=await fetch(`${this.urlBase}/movie/top_rated?api_key=899ff14e8c54a1207e2a3795988ebb78&language=ru-RU&page=${this.countPages}`);if(e.ok){const s=await e.json();this.bestMovies=s.results}else console.log("kdjfghd");this.genres.length>0&&(this.loaded=!0)},async getDataGenres(){const e=await fetch(`${this.urlBase}/genre/movie/list?api_key=899ff14e8c54a1207e2a3795988ebb78&language=ru-RU`);if(e.ok){const s=await e.json();this.genres=s.genres}else console.log("kdjfghd");this.bestMovies.length>0&&(this.loaded=!0)},async getFilterMovies(){this.loaded=!1,this.domenFilter="",this.genresFilter.length>0&&(this.domenFilter+=`&with_genres=${this.genresFilter}`),this.ratingFilter.length>0&&(this.domenFilter+=`&vote_average.gte=${this.ratingFilter[0]}&vote_average.lte=${this.ratingFilter[1]}`),this.fromDateFilter.length>0&&(this.domenFilter+=`&primary_release_date.gte=${this.fromDateFilter}`),this.toDateFilter.length>0&&(this.domenFilter+=`&primary_release_date.lte=${this.toDateFilter}`),this.typeSort.length>0&&(this.domenFilter+=`&sort_by=${this.typeSort}`);const e=await fetch(`${this.urlBase}/discover/movie?api_key=899ff14e8c54a1207e2a3795988ebb78&with_genres=${this.domenFilter}&vote_count.gte=100&language=ru-RU&page=${this.countPages}`);if(e.ok){const s=await e.json();this.bestMovies=s.results}else console.log("kdjfghd");this.loaded=!0},getDataFilter(t,e,s,g){this.genresFilter=t.join(","),this.ratingFilter=e,this.fromDateFilter=s,this.toDateFilter=g,this.countPages=1,this.getFilterMovies()},getDataSort(t){this.countPages=1,this.typeSort=t,this.getFilterMovies()},openNewPage(t){this.countPages=t,this.domenFilter.length>0?this.getFilterMovies():this.getBestMovies()}},mounted(){this.getBestMovies(),this.getDataGenres()}},M={class:"filters-container"},B={key:0,class:"load-animation-container"};function w(t,e,s,g,i,a){const d=o("ui-filter"),u=o("ui-sorting"),p=o("list-movies"),f=o("ui-pagination");return l(),h(k,null,[n("div",M,[r(d,{genres:i.genres,onFilterData:a.getDataFilter},null,8,["genres","onFilterData"]),r(u,{onSortData:a.getDataSort},null,8,["onSortData"])]),i.loaded?c("",!0):(l(),h("div",B,[...e[0]||(e[0]=[n("i",{class:"fa-solid fa-circle-notch fa-spin"},null,-1)])])),i.loaded?(l(),D(p,{key:1,movies:i.bestMovies,genres:i.genres},null,8,["movies","genres"])):c("",!0),n("div",{class:b(["pagination-hidden-container",this.loaded?"":"hidden-block"])},[r(f,{countPages:i.countPages,onUpdateCountPage:a.openNewPage},null,8,["countPages","onUpdateCountPage"])],2)],64)}const j=y(P,[["render",w],["__scopeId","data-v-85748400"]]);export{j as default};
