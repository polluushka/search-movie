import{U as F,a as y,b as D,L as $}from"./UiPagination-CAhwtkiI.js";import{_ as h,c as u,a as r,o as c,U as k,b as n,w as b,d as U,e as V,F as w,r as i}from"./index-xV3gJSDm.js";import{U as P}from"./UiButton-hMMIuBjI.js";const S={emits:["update:modelValue"],props:{modelValue:{type:String,required:!0,default:""}}},B={class:"search-container"};function M(t,e,s,l,a,o){return c(),u("div",B,[r("input",{type:"text",id:"search",name:"search",class:"search-input filter-settings",placeholder:"Поиск",onInput:e[0]||(e[0]=g=>t.$emit("update:modelValue",g.target.value))},null,32)])}const j=h(S,[["render",M],["__scopeId","data-v-baf98614"]]),C={components:{ListMovies:$,UiHeader:k,UiSearch:j,UiFilter:D,UiSorting:y,UiButton:P,UiPagination:F},data(){return{urlBase:"https://api.themoviedb.org/3",movies:[],genres:[],searchValue:"",domenFilter:"",genresFilter:"",ratingFilter:[],fromDateFilter:"",toDateFilter:"",typeSort:"",loated:!1,countPages:1}},methods:{async getDataMovies(){const e=await fetch(`${this.urlBase}/movie/popular?api_key=899ff14e8c54a1207e2a3795988ebb78&language=ru-RU&page=${this.countPages}`);if(e.ok){const s=await e.json();this.movies=s.results}else console.log("kdjfghd");this.genres.length>0&&(this.loated=!0)},async getDataGenres(){const e=await fetch(`${this.urlBase}/genre/movie/list?api_key=899ff14e8c54a1207e2a3795988ebb78&language=ru-RU`);if(e.ok){const s=await e.json();this.genres=s.genres}else console.log("kdjfghd");this.movies.length>0&&(this.loated=!0)},async getFilterMovies(){this.domenFilter="",this.genresFilter.length>0&&(this.domenFilter+=`&with_genres=${this.genresFilter}`),this.ratingFilter.length>0&&(this.domenFilter+=`&vote_average.gte=${this.ratingFilter[0]}&vote_average.lte=${this.ratingFilter[1]}`),this.fromDateFilter.length>0&&(this.domenFilter+=`&primary_release_date.gte=${this.fromDateFilter}`),this.toDateFilter.length>0&&(this.domenFilter+=`&primary_release_date.lte=${this.toDateFilter}`),this.typeSort.length>0&&(this.domenFilter+=`&sort_by=${this.typeSort}`);const e=await fetch(`${this.urlBase}/discover/movie?api_key=899ff14e8c54a1207e2a3795988ebb78&with_genres=${this.domenFilter}&vote_count.gte=100&language=ru-RU&page=${this.countPages}`);if(e.ok){const s=await e.json();this.movies=s.results}else console.log("kdjfghd")},getDataFilter(t,e,s,l){this.genresFilter=t.join(","),this.ratingFilter=e,this.fromDateFilter=s,this.toDateFilter=l,this.getFilterMovies()},getDataSort(t){this.typeSort=t,this.getFilterMovies()},getSearchValue(t){this.searchValue=t},async searchMovie(){const t="899ff14e8c54a1207e2a3795988ebb78";let e="";if(this.searchValue.length>0?e=await fetch(`${this.urlBase}/search/movie?api_key=${t}&query=${this.searchValue}&language=ru-RU&page=1`):e=await fetch(`${this.urlBase}/movie/popular?api_key=${t}&language=ru-RU&page=1`),e.ok){const s=await e.json();this.movies=s.results}else console.log("kdjfghd")},openNewPage(t){this.countPages=t,this.domenFilter.length>0?this.getFilterMovies():this.getDataMovies()}},mounted(){this.getDataMovies(),this.getDataGenres()}},K={class:"filters-container"},x={class:"search-button-container"};function N(t,e,s,l,a,o){const g=i("ui-search"),p=i("ui-button"),d=i("ui-filter"),m=i("ui-sorting"),f=i("list-movies"),_=i("ui-pagination");return c(),u(w,null,[r("div",K,[r("div",x,[n(g,{modelValue:a.searchValue,"onUpdate:modelValue":e[0]||(e[0]=v=>a.searchValue=v)},null,8,["modelValue"]),n(p,{onClick:o.searchMovie},{default:b(()=>[...e[1]||(e[1]=[r("i",{class:"fa-solid fa-magnifying-glass"},null,-1)])]),_:1},8,["onClick"])]),n(d,{genres:a.genres,onFilterData:o.getDataFilter},null,8,["genres","onFilterData"]),n(m,{onSortData:o.getDataSort},null,8,["onSortData"])]),a.loated?(c(),U(f,{key:0,movies:a.movies,genres:a.genres},null,8,["movies","genres"])):V("",!0),n(_,{countPages:a.countPages,onUpdateCountPage:o.openNewPage},null,8,["countPages","onUpdateCountPage"])],64)}const G=h(C,[["render",N],["__scopeId","data-v-e5af256b"]]);export{G as default};
