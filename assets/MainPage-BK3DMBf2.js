import{U as M,a as F}from"./UiButton-Bc0uvOET.js";import{_ as m,c as u,a as i,b as g,t as h,F as p,r as f,d as c,o as r,w as y,v as b,e as _,f as w,g as x,h as U,i as $,j as P,n as S,U as B}from"./index-BkxYwKO0.js";const I={components:{UiRating:M},props:{movie:{type:Object,required:!0},genres:{type:Array,required:!0}},data(){return{yearRelease:"",urlBase:"https://api.themoviedb.org/3"}},methods:{getGenres(t){return t.map(e=>this.genres.find(s=>s.id==e))},openMoviePage(){this.$router.push(`/search-movie/movie/${this.movie.id}`)}},computed:{returnYearRelease(){const t=new Date(this.movie.release_date);return this.yearRelease=t.getFullYear(),this.yearRelease}},mounted(){}},j={class:"item-movie-content"},N={class:"movie-img-container"},A=["src"],q={class:"item-movie-title"},L={class:"item-movie-description"},G={class:"list-row-container"},K={class:"list-row-elem"};function E(t,e,s,d,o,a){const l=c("ui-rating");return r(),u("div",{class:"item-movie-container",onClick:e[0]||(e[0]=(...n)=>a.openMoviePage&&a.openMoviePage(...n))},[i("div",j,[i("div",N,[g(l,{rating:s.movie.vote_average},null,8,["rating"]),i("img",{src:`https://image.tmdb.org/t/p/w342${s.movie.poster_path}`,loading:"lazy",alt:"",class:"item-movie-img"},null,8,A)]),i("div",q,[i("h3",null,h(s.movie.title),1)]),i("div",L,[i("p",null,h(a.returnYearRelease),1),i("ul",G,[(r(!0),u(p,null,f(a.getGenres(s.movie.genre_ids),n=>(r(),u("li",K,h(n.name),1))),256))])])])])}const D=m(I,[["render",E],["__scopeId","data-v-444c2cdf"]]),H={components:{ItemMovie:D},props:{movies:{type:Array,required:!0},genres:{type:Array,required:!0}},data(){return{}}},z={class:"list-movies-container"},T={class:"item-movie"};function Y(t,e,s,d,o,a){const l=c("item-movie");return r(),u("div",z,[(r(!0),u(p,null,f(s.movies,n=>(r(),u("div",T,[g(l,{movie:n,genres:s.genres},null,8,["movie","genres"])]))),256))])}const O=m(H,[["render",Y],["__scopeId","data-v-e156d6a2"]]),J={emits:["update:modelValue"],props:{modelValue:{type:String,required:!0,default:""}}},Q={class:"search-container"};function W(t,e,s,d,o,a){return r(),u("div",Q,[i("input",{type:"text",id:"search",name:"search",class:"search-input filter-settings",placeholder:"Поиск",onInput:e[0]||(e[0]=l=>t.$emit("update:modelValue",l.target.value))},null,32)])}const X=m(J,[["render",W],["__scopeId","data-v-baf98614"]]),Z={emits:["filterData"],props:{genres:{type:Array,required:!0}},components:{UiButton:F},data(){return{genresFilter:[],rangeRating:[],fromDateFilter:"",toDateFilter:""}},methods:{toogleHiddenMenu(){document.querySelector(".filter-menu-container").classList.toggle("hidden-menu")},setGenresFilter(t){const e=document.getElementById(t);e.classList.toggle("active-button"),e.classList.contains("active-button")?this.genresFilter.push(t):this.genresFilter.splice(this.genresFilter.indexOf(t),1)},setRatingFilter(t){const e=document.getElementById(t),s=Number(e.innerText);if(this.rangeRating.length<2?(this.rangeRating.push(s),s!==10&&this.rangeRating.push(s+.9),e.classList.add("active-button")):Math.abs(s-this.rangeRating[0])<Math.abs(s-this.rangeRating[1])?this.rangeRating.splice(0,1,s):this.rangeRating.splice(1,2,s),this.rangeRating.length===2)for(let d=1;d<=10;d++){let o=document.getElementById(`rating-${d}`);d>=this.rangeRating[0]&&d<=this.rangeRating[1]?o.classList.add("active-button"):o.classList.remove("active-button")}},sendDataFilter(){this.$emit("filterData",this.genresFilter,this.rangeRating,this.fromDateFilter,this.toDateFilter)}}},ee={class:"filter-container"},te={class:"filter-menu-container hidden-menu"},ie={class:"genres-filter-container"},se=["id","onClick"],ne={class:"rating-filter-container"},ae=["id","onClick"],oe={class:"date-filter-container"},re={class:"date-container"},le={class:"date-container"};function ue(t,e,s,d,o,a){const l=c("ui-button");return r(),u("div",ee,[i("button",{class:"filter-button filter-settings",onClick:e[0]||(e[0]=(...n)=>a.toogleHiddenMenu&&a.toogleHiddenMenu(...n))},[...e[3]||(e[3]=[i("p",null,"Фильтры",-1),i("i",{class:"fa-solid fa-sliders"},null,-1)])]),i("div",te,[e[7]||(e[7]=i("p",{class:"title-filter"},"Жанры",-1)),i("div",ie,[(r(!0),u(p,null,f(s.genres,n=>(r(),u("button",{class:"filter-button-menu",id:`${n.id}`,onClick:v=>a.setGenresFilter(n.id)},h(n.name),9,se))),256))]),e[8]||(e[8]=i("p",{class:"title-filter"},"Рейтинг",-1)),e[9]||(e[9]=i("p",{class:"p-filter"},"Выберите диапазон",-1)),i("div",ne,[(r(),u(p,null,f(10,n=>i("button",{class:"filter-button-menu one-width",id:`rating-${n}`,onClick:v=>a.setRatingFilter(`rating-${n}`)},h(n),9,ae)),64))]),e[10]||(e[10]=i("p",{class:"title-filter"},"Дата выхода",-1)),i("div",oe,[i("div",re,[e[4]||(e[4]=i("label",{for:"from-date-filter",class:"label-date-filter"},"От",-1)),y(i("input",{type:"date",class:"input-date-filter",id:"from-date-filter","onUpdate:modelValue":e[1]||(e[1]=n=>o.fromDateFilter=n),name:"from-date-filter"},null,512),[[b,o.fromDateFilter]])]),i("div",le,[e[5]||(e[5]=i("label",{for:"to-date-filter",class:"label-date-filter"},"До",-1)),y(i("input",{type:"date",class:"input-date-filter",id:"to-date-filter","onUpdate:modelValue":e[2]||(e[2]=n=>o.toDateFilter=n),name:"to-date-filter"},null,512),[[b,o.toDateFilter]])])]),g(l,{onClick:a.sendDataFilter,style:{"font-size":"0.75rem"}},{default:_(()=>[...e[6]||(e[6]=[w("Найти",-1)])]),_:1},8,["onClick"])])])}const de=m(Z,[["render",ue],["__scopeId","data-v-0d78b3b5"]]),ce={emits:["sortData"],data(){return{sortValue:"popularity.desc"}},methods:{sendDataSort(){this.$emit("sortData",this.sortValue)}}},ge={class:"sorting-container"};function me(t,e,s,d,o,a){return r(),u("div",ge,[y(i("select",{name:"sort",id:"sort",class:"sort-select filter-settings","onUpdate:modelValue":e[0]||(e[0]=l=>o.sortValue=l),onChange:e[1]||(e[1]=(...l)=>a.sendDataSort&&a.sendDataSort(...l))},[...e[2]||(e[2]=[U('<option value="popularity.desc" data-v-2b503d82>Сначала популярные</option><option value="popularity.asc" data-v-2b503d82>Сначала непопулярные</option><option value="vote_average.desc" data-v-2b503d82>Сначала лучшие</option><option value="vote_average.asc" data-v-2b503d82>Сначала худшие</option><option value="primary_release_date.desc" data-v-2b503d82>Сначала новые</option><option value="primary_release_date.asc" data-v-2b503d82>Сначала старые</option>',6)])],544),[[x,o.sortValue]])])}const he=m(ce,[["render",me],["__scopeId","data-v-2b503d82"]]),pe={components:{UiButton:F},emits:["updateCountPage"],data(){return{pagination:[1,2,3,4,5,6,7,8,9,10],minPage:1,maxPage:9,currentPage:1}},methods:{getPaginationArray(t){this.currentPage=t,this.currentPage>5?(this.minPage=t-4,this.maxPage=t+4):(this.minPage=1,this.maxPage=9),this.$emit("updateCountPage",this.currentPage)},openNextPage(){this.currentPage++,this.getPaginationArray(this.currentPage),this.$emit("updateCountPage",this.currentPage)},openPreviousPage(){this.currentPage--,this.getPaginationArray(this.currentPage),this.$emit("updateCountPage",this.currentPage)}},computed:{updatePaginationArray(){this.pagination=[];for(let t=this.minPage;t<=this.maxPage;t++)this.pagination.push(t);return this.pagination}}},fe={class:"pagination-container"},ve={class:"pages-container"},_e=["onClick"];function ye(t,e,s,d,o,a){const l=c("ui-button");return r(),u("div",fe,[i("div",ve,[this.currentPage>1?(r(),$(l,{key:0,onClick:e[0]||(e[0]=n=>a.openPreviousPage())},{default:_(()=>[...e[2]||(e[2]=[i("i",{class:"fa-solid fa-chevron-left"},null,-1)])]),_:1})):P("",!0),(r(!0),u(p,null,f(a.updatePaginationArray,n=>(r(),u("button",{class:S(["button-pagination",this.currentPage===n?"current-page-button":""]),onClick:v=>a.getPaginationArray(n)},h(n),11,_e))),256)),g(l,{onClick:e[1]||(e[1]=n=>a.openNextPage())},{default:_(()=>[...e[3]||(e[3]=[i("i",{class:"fa-solid fa-chevron-right"},null,-1)])]),_:1})])])}const Fe=m(pe,[["render",ye],["__scopeId","data-v-805c04d4"]]),be={components:{ItemMovie:D,ListMovies:O,UiHeader:B,UiSearch:X,UiFilter:de,UiSorting:he,UiButton:F,UiPagination:Fe},data(){return{urlBase:"https://api.themoviedb.org/3",movies:[],genres:[],searchValue:"",domenFilter:"",genresFilter:"",ratingFilter:[],fromDateFilter:"",toDateFilter:"",typeSort:"",loated:!1,countPages:1}},methods:{async getDataMovies(){const e=await fetch(`${this.urlBase}/movie/popular?api_key=899ff14e8c54a1207e2a3795988ebb78&language=ru-RU&page=${this.countPages}`);if(e.ok){const s=await e.json();this.movies=s.results}else console.log("kdjfghd");this.genres.length>0&&(this.loated=!0)},async getDataGenres(){const e=await fetch(`${this.urlBase}/genre/movie/list?api_key=899ff14e8c54a1207e2a3795988ebb78&language=ru-RU`);if(e.ok){const s=await e.json();this.genres=s.genres}else console.log("kdjfghd");this.movies.length>0&&(this.loated=!0)},async getFilterMovies(){this.domenFilter="",this.genresFilter.length>0&&(this.domenFilter+=`&with_genres=${this.genresFilter}`),this.ratingFilter.length>0&&(this.domenFilter+=`&vote_average.gte=${this.ratingFilter[0]}&vote_average.lte=${this.ratingFilter[1]}`),this.fromDateFilter.length>0&&(this.domenFilter+=`&primary_release_date.gte=${this.fromDateFilter}`),this.toDateFilter.length>0&&(this.domenFilter+=`&primary_release_date.lte=${this.toDateFilter}`),this.typeSort.length>0&&(this.domenFilter+=`&sort_by=${this.typeSort}`);const e=await fetch(`${this.urlBase}/discover/movie?api_key=899ff14e8c54a1207e2a3795988ebb78&with_genres=${this.domenFilter}&vote_count.gte=100&language=ru-RU&page=${this.countPages}`);if(e.ok){const s=await e.json();this.movies=s.results}else console.log("kdjfghd")},getDataFilter(t,e,s,d){this.genresFilter=t.join(","),this.ratingFilter=e,this.fromDateFilter=s,this.toDateFilter=d,this.getFilterMovies()},getDataSort(t){this.typeSort=t,this.getFilterMovies()},getSearchValue(t){this.searchValue=t},async searchMovie(){const t="899ff14e8c54a1207e2a3795988ebb78";let e="";if(this.searchValue.length>0?e=await fetch(`${this.urlBase}/search/movie?api_key=${t}&query=${this.searchValue}&language=ru-RU&page=1`):e=await fetch(`${this.urlBase}/movie/popular?api_key=${t}&language=ru-RU&page=1`),e.ok){const s=await e.json();this.movies=s.results}else console.log("kdjfghd")},openNewPage(t){this.countPages=t,this.domenFilter.length>0?this.getFilterMovies():this.getDataMovies()}},computed:{},mounted(){this.getDataMovies(),this.getDataGenres()}},$e={class:"filters-container"},Pe={class:"search-button-container"};function De(t,e,s,d,o,a){const l=c("ui-search"),n=c("ui-button"),v=c("ui-filter"),k=c("ui-sorting"),C=c("list-movies"),R=c("ui-pagination");return r(),u(p,null,[i("div",$e,[i("div",Pe,[g(l,{modelValue:o.searchValue,"onUpdate:modelValue":e[0]||(e[0]=V=>o.searchValue=V)},null,8,["modelValue"]),g(n,{onClick:a.searchMovie},{default:_(()=>[...e[1]||(e[1]=[i("i",{class:"fa-solid fa-magnifying-glass"},null,-1)])]),_:1},8,["onClick"])]),g(v,{genres:o.genres,onFilterData:a.getDataFilter},null,8,["genres","onFilterData"]),g(k,{onSortData:a.getDataSort},null,8,["onSortData"])]),o.loated?(r(),$(C,{key:0,movies:o.movies,genres:o.genres},null,8,["movies","genres"])):P("",!0),g(R,{countPages:o.countPages,onUpdateCountPage:a.openNewPage},null,8,["countPages","onUpdateCountPage"])],64)}const Re=m(be,[["render",De],["__scopeId","data-v-f040af91"]]);export{Re as default};
