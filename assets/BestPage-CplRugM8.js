import{U as p,b as m,a as d,L as _}from"./UiPagination-CAhwtkiI.js";import{_ as f,c as F,a as v,b as n,d as y,e as D,F as b,r as o,o as l}from"./index-xV3gJSDm.js";import"./UiButton-hMMIuBjI.js";const P={components:{ListMovies:_,UiSorting:d,UiFilter:m,UiPagination:p},data(){return{urlBase:"https://api.themoviedb.org/3",bestMovies:[],genres:[],loated:!1,domenFilter:"",genresFilter:"",ratingFilter:[],fromDateFilter:"",toDateFilter:"",typeSort:"vote_average.desc",countPages:1}},methods:{async getBestMovies(){const e=await fetch(`${this.urlBase}/movie/top_rated?api_key=899ff14e8c54a1207e2a3795988ebb78&language=ru-RU&page=${this.countPages}`);if(e.ok){const s=await e.json();this.bestMovies=s.results}else console.log("kdjfghd");this.genres.length>0&&(this.loated=!0)},async getDataGenres(){const e=await fetch(`${this.urlBase}/genre/movie/list?api_key=899ff14e8c54a1207e2a3795988ebb78&language=ru-RU`);if(e.ok){const s=await e.json();this.genres=s.genres}else console.log("kdjfghd");this.bestMovies.length>0&&(this.loated=!0)},async getFilterMovies(){this.domenFilter="",this.genresFilter.length>0&&(this.domenFilter+=`&with_genres=${this.genresFilter}`),this.ratingFilter.length>0&&(this.domenFilter+=`&vote_average.gte=${this.ratingFilter[0]}&vote_average.lte=${this.ratingFilter[1]}`),this.fromDateFilter.length>0&&(this.domenFilter+=`&primary_release_date.gte=${this.fromDateFilter}`),this.toDateFilter.length>0&&(this.domenFilter+=`&primary_release_date.lte=${this.toDateFilter}`),this.typeSort.length>0&&(this.domenFilter+=`&sort_by=${this.typeSort}`);const e=await fetch(`${this.urlBase}/discover/movie?api_key=899ff14e8c54a1207e2a3795988ebb78&with_genres=${this.domenFilter}&vote_count.gte=100&language=ru-RU&page=${this.countPages}`);if(e.ok){const s=await e.json();this.bestMovies=s.results}else console.log("kdjfghd")},getDataFilter(t,e,s,r){this.genresFilter=t.join(","),this.ratingFilter=e,this.fromDateFilter=s,this.toDateFilter=r,this.countPages=1,this.getFilterMovies()},getDataSort(t){this.countPages=1,this.typeSort=t,this.getFilterMovies()},openNewPage(t){this.countPages=t,this.domenFilter.length>0?this.getFilterMovies():this.getBestMovies()}},mounted(){this.getBestMovies(),this.getDataGenres()}},k={class:"filters-container"};function M(t,e,s,r,i,a){const g=o("ui-filter"),h=o("ui-sorting"),c=o("list-movies"),u=o("ui-pagination");return l(),F(b,null,[v("div",k,[n(g,{genres:i.genres,onFilterData:a.getDataFilter},null,8,["genres","onFilterData"]),n(h,{onSortData:a.getDataSort},null,8,["onSortData"])]),i.loated?(l(),y(c,{key:0,movies:i.bestMovies,genres:i.genres},null,8,["movies","genres"])):D("",!0),n(u,{countPages:i.countPages,onUpdateCountPage:a.openNewPage},null,8,["countPages","onUpdateCountPage"])],64)}const S=f(P,[["render",M],["__scopeId","data-v-2f3c77aa"]]);export{S as default};
