import{U as y,a as k,b as D,L as $}from"./UiPagination-Bw0lHdnJ.js";import{_ as d,c as h,a as o,o as l,U as P,b as r,w as b,d as U,e as u,n as V,F as w,r as i}from"./index-D2VDRkuz.js";import{U as S}from"./UiButton-DPe_yz0q.js";const B={emits:["update:modelValue"],props:{modelValue:{type:String,required:!0,default:""}}},M={class:"search-container"};function j(t,e,s,g,a,n){return l(),h("div",M,[o("input",{type:"text",id:"search",name:"search",class:"search-input filter-settings",placeholder:"Поиск",onInput:e[0]||(e[0]=c=>t.$emit("update:modelValue",c.target.value))},null,32)])}const C=d(B,[["render",j],["__scopeId","data-v-baf98614"]]),K={components:{ListMovies:$,UiHeader:P,UiSearch:C,UiFilter:D,UiSorting:k,UiButton:S,UiPagination:y},data(){return{urlBase:"https://api.themoviedb.org/3",movies:[],genres:[],searchValue:"",domenFilter:"",genresFilter:"",ratingFilter:[],fromDateFilter:"",toDateFilter:"",typeSort:"",loaded:!1,countPages:1,totalPages:null}},methods:{async getDataMovies(){this.loaded=!1;const e=await fetch(`${this.urlBase}/movie/popular?api_key=899ff14e8c54a1207e2a3795988ebb78&language=ru-RU&page=${this.countPages}`);if(e.ok){const s=await e.json();this.totalPages=Number(s.total_pages),this.movies=s.results}else console.log("kdjfghd");this.genres.length>0&&(this.loaded=!0)},async getDataGenres(){const e=await fetch(`${this.urlBase}/genre/movie/list?api_key=899ff14e8c54a1207e2a3795988ebb78&language=ru-RU`);if(e.ok){const s=await e.json();this.genres=s.genres}else console.log("kdjfghd");this.movies.length>0&&(this.loaded=!0)},async getFilterMovies(){this.loaded=!1,this.domenFilter="",this.genresFilter.length>0&&(this.domenFilter+=`&with_genres=${this.genresFilter}`),this.ratingFilter.length>0&&(this.domenFilter+=`&vote_average.gte=${this.ratingFilter[0]}&vote_average.lte=${this.ratingFilter[1]}`),this.fromDateFilter.length>0&&(this.domenFilter+=`&primary_release_date.gte=${this.fromDateFilter}`),this.toDateFilter.length>0&&(this.domenFilter+=`&primary_release_date.lte=${this.toDateFilter}`),this.typeSort.length>0&&(this.domenFilter+=`&sort_by=${this.typeSort}`);const e=await fetch(`${this.urlBase}/discover/movie?api_key=899ff14e8c54a1207e2a3795988ebb78&with_genres=${this.domenFilter}&language=ru-RU&page=${this.countPages}`);if(e.ok){const s=await e.json();this.totalPages=Number(s.total_pages),this.movies=s.results}else console.log("kdjfghd");this.loaded=!0},getDataFilter(t,e,s,g){this.genresFilter=t.join(","),this.ratingFilter=e,this.fromDateFilter=s,this.toDateFilter=g,this.getFilterMovies()},getDataSort(t){this.typeSort=t,this.getFilterMovies()},getSearchValue(t){this.searchValue=t},async searchMovie(){const t="899ff14e8c54a1207e2a3795988ebb78";let e="";if(this.searchValue.length>0?e=await fetch(`${this.urlBase}/search/movie?api_key=${t}&query=${this.searchValue}&language=ru-RU&page=1`):e=await fetch(`${this.urlBase}/movie/popular?api_key=${t}&language=ru-RU&page=1`),e.ok){const s=await e.json();this.movies=s.results}else console.log("kdjfghd")},openNewPage(t){this.countPages=t,this.domenFilter.length>0?this.getFilterMovies():this.getDataMovies()}},mounted(){this.getDataMovies(),this.getDataGenres()}},N={class:"filters-container"},x={class:"search-button-container"},R={key:1,class:"load-animation-container"};function I(t,e,s,g,a,n){const c=i("ui-search"),p=i("ui-button"),m=i("ui-filter"),f=i("ui-sorting"),_=i("list-movies"),v=i("ui-pagination");return l(),h(w,null,[o("div",N,[o("div",x,[r(c,{modelValue:a.searchValue,"onUpdate:modelValue":e[0]||(e[0]=F=>a.searchValue=F)},null,8,["modelValue"]),r(p,{onClick:n.searchMovie},{default:b(()=>[...e[1]||(e[1]=[o("i",{class:"fa-solid fa-magnifying-glass"},null,-1)])]),_:1},8,["onClick"])]),r(m,{genres:a.genres,onFilterData:n.getDataFilter},null,8,["genres","onFilterData"]),r(f,{onSortData:n.getDataSort},null,8,["onSortData"])]),this.loaded?(l(),U(_,{key:0,movies:a.movies,genres:a.genres},null,8,["movies","genres"])):u("",!0),this.loaded?u("",!0):(l(),h("div",R,[...e[2]||(e[2]=[o("i",{class:"fa-solid fa-circle-notch fa-spin"},null,-1)])])),o("div",{class:V(["pagination-hidden-container",this.loaded&&this.totalPages>1?"":"hidden-block"])},[r(v,{countPages:a.countPages,onUpdateCountPage:n.openNewPage,totalPages:a.totalPages},null,8,["countPages","onUpdateCountPage","totalPages"])],2)],64)}const z=d(K,[["render",I],["__scopeId","data-v-5391ccc5"]]);export{z as default};
